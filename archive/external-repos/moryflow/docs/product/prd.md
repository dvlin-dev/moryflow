## 📄 文档一：产品文档（对外 / 内部一致）

### 1) 一句话定位

**Moryflow = 私密 Chat + Notes（聊天 × 笔记 × 语音）**，默认**本地优先**与**端到端加密（E2EE）**；可接入远程算力但**云端零正文留存**，仅在需要时把“向量”托管到服务端以支持语义检索。

### 2) 目标用户

- 注重数据主权与隐私的个人开发者/团队
- 希望“离线也好用”的知识工作者（写作、科研、工程）

### 3) 运行形态（版本）

- **Free · Local‑Only（默认）**：LLM/Embedding/存储/搜索全部在本地；iCloud/OSS 仅同步**密文事件**。

  - **Self‑host**：自部署闭源镜像（网关/Pro API）；**零正文留存**。
  - **BYOK**：在端侧填写第三方 API Key 直连推理，默认不把 Key 上送服务端。

- **Pro API（订阅）**：官方托管端点，响应更快/模型更强；同样**不保存对话正文**，Embedding 只**持久化向量**与必要元数据。

### 4) 核心理念

- **本地优先、正文不上云**：所有会话与笔记正文只在端侧加密存储与解密展示。
- **向量可上云（可选）**：为实现跨端/长历史的语义检索，可把文本**嵌入为向量**写入服务端，只存向量 + 必要元数据 + `docRef`；检索仅返回 `docRef + score`，端侧据此展示明文。
- **命名空间隔离**：`embed:{model}:{dim}:{metric}:{provider}:{version}`，便于模型切换与重嵌迁移。

### 5) 关键能力

- **聊天 × 笔记**：对话/语音先生成“清洗预览”，确认后入库（本地加密），再触发向量写入以支持语义检索。
- **搜索**：关键词 + 语义检索（向量）；Local / Self‑host / Official 三形态自动裁剪。
- **同步与可迁移**：iCloud/OSS 仅承载密文事件；命名空间并行 + 懒重嵌，模型迭代平滑。

### 6) 差异化卖点

- **强隐私**：云端零正文日志，仅聚合指标（QPS/时延/错误率）。
- **可自托管 / 可 BYOK**：满足企业与个人多样合规场景。
- **开源客户端 + 协议/SDK**；远端镜像闭源交付（签名与 SBOM）。

### 7) 路线图（高层）

**P0 → P1 → P2**：先打通 Pro API（核心链路），再交付授权形态（自托管/BYOK），最后深化 Local‑Only（本地 LLM/Embedding/STT）。

### 8) 常见问答（节选）

- **Q：上云的向量是否泄露隐私？**
  **A**：服务端只存向量与元数据，检索只回 `docRef+score`；正文始终在端侧解密展示。
- **Q：Self‑host 是否免费？**
- **Q：从付费切回本地会怎样？**
  **A**：命名空间隔离 + 懒重嵌；双索引并行完成后清理旧索引，体验平滑。
