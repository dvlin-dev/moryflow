# Mobile æ™ºèƒ½æ£€ç´¢

## éœ€æ±‚

Mobile ç«¯æ¥å…¥è¯­ä¹‰æœç´¢ï¼š
- å¤ç”¨åç«¯ `/api/search` æ¥å£
- åœ¨æœç´¢é¡µå¢åŠ "æ™ºèƒ½æœç´¢"æ¨¡å¼
- æ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢ç¬”è®°å†…å®¹

## æŠ€æœ¯æ–¹æ¡ˆ

### æ¶æ„

```
Mobile App
â”œâ”€â”€ æœç´¢é¡µ (app/(tabs)/search)
â”‚   â”œâ”€â”€ æœ¬åœ°æœç´¢ï¼ˆæ–‡ä»¶ååŒ¹é…ï¼‰
â”‚   â””â”€â”€ æ™ºèƒ½æœç´¢ï¼ˆè¯­ä¹‰æœç´¢ï¼‰
â”‚
â””â”€â”€ cloudSyncApi.search() â†’ POST /api/search â†’ Cloudflare Vectorize
```

### ä¸äº‘åŒæ­¥çš„å…³ç³»

```
äº‘åŒæ­¥ï¼ˆå¿…éœ€ï¼‰
â””â”€â”€ æ–‡ä»¶ä¸Šä¼ åˆ°äº‘ç«¯
    â””â”€â”€ å‘é‡åŒ–ï¼ˆåå°è‡ªåŠ¨ï¼Œcommit æ—¶è§¦å‘ï¼‰
        â””â”€â”€ æ™ºèƒ½æ£€ç´¢ï¼ˆè°ƒç”¨æœç´¢ APIï¼‰
```

### æœç´¢æ¨¡å¼å¯¹æ¯”

| ç‰¹æ€§ | æœ¬åœ°æœç´¢ | æ™ºèƒ½æœç´¢ |
|------|----------|----------|
| æœç´¢èŒƒå›´ | æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶ | å…¨éƒ¨å·²åŒæ­¥æ–‡ä»¶ |
| åŒ¹é…æ–¹å¼ | æ–‡ä»¶ååŒ…å« | è¯­ä¹‰ç›¸ä¼¼åº¦ |
| ç¦»çº¿å¯ç”¨ | âœ“ | âœ— |
| éœ€ç™»å½• | âœ— | âœ“ |

### æ ¸å¿ƒé€»è¾‘ï¼ˆä¼ªä»£ç ï¼‰

```
# æœç´¢æµç¨‹
onSearch(query):
  if mode == 'local':
    return filterByQuery(recentItems, query)
  else:
    if not isLoggedIn or not cloudSyncEnabled:
      return showEmptyState()
    debounce(500ms)
    return cloudSyncApi.search({ query, vaultId, topK: 20 })

# ç»“æœç‚¹å‡»å¤„ç†
onResultPress(result):
  localPath = fileIndexManager.getByFileId(vaultPath, result.fileId)
  if localPath:
    router.push(`/(editor)/${result.fileId}`)
  else:
    alert('æ–‡ä»¶å°šæœªåŒæ­¥ï¼Œæ˜¯å¦ç«‹å³åŒæ­¥ï¼Ÿ')
```

### UI è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” æœç´¢ç¬”è®°...                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ¬åœ°æœç´¢        â”‚  æ™ºèƒ½æœç´¢ âœ¨            â”‚ â† SwiftUI Picker
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ å‘¨ä¼šè®°å½•.md              ç›¸å…³åº¦: 92%   â”‚
â”‚    notes/work/                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ é¡¹ç›®è¿›åº¦.md              ç›¸å…³åº¦: 85%   â”‚
â”‚    notes/work/                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç©ºçŠ¶æ€åœºæ™¯

| åœºæ™¯ | æ˜¾ç¤º |
|------|------|
| æœªç™»å½• | ç™»å½•åå¼€å¯æ™ºèƒ½æœç´¢ + ç™»å½•æŒ‰é’® |
| äº‘åŒæ­¥æœªå¯ç”¨ | å¼€å¯äº‘åŒæ­¥ä»¥ä½¿ç”¨æ™ºèƒ½æœç´¢ + å‰å¾€è®¾ç½® |
| æ— æœç´¢ç»“æœ | è¯•è¯•å…¶ä»–å…³é”®è¯ |

## ä»£ç ç´¢å¼•

| æ¨¡å— | è·¯å¾„ |
|------|------|
| æœç´¢ API | `apps/mobile/lib/cloud-sync/api-client.ts` |
| æœç´¢ Hook | `apps/mobile/app/(tabs)/search/hooks/use-semantic-search.ts` |
| æœç´¢é¡µ | `apps/mobile/app/(tabs)/search/index.tsx` |
| æ¨¡å¼åˆ‡æ¢ | `apps/mobile/app/(tabs)/search/components/SearchModeToggle.tsx` |
| ç»“æœå±•ç¤º | `apps/mobile/app/(tabs)/search/components/SemanticResults.tsx` |
