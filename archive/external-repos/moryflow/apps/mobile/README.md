# Moryflow Mobile

> æœ¬åœ° Agent + Vault æ–‡ä»¶æ¶æ„çš„ç§»åŠ¨ç«¯å®ç°

## æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸ¤– **æœ¬åœ° Agent** | ä½¿ç”¨ `@moryflow/agents-*` å…±äº«åŒ…ï¼Œåœ¨è®¾å¤‡ä¸Šè¿è¡Œ AI Agent |
| ğŸ“ **Vault æ–‡ä»¶ç³»ç»Ÿ** | åŸºäº `expo-file-system`ï¼Œæœ¬åœ°ä¼˜å…ˆçš„æ–‡ä»¶ç®¡ç† |
| âœï¸ **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨** | WebView + TipTapï¼Œæ”¯æŒ Markdown å’Œæ‰€è§å³æ‰€å¾— |
| ğŸ” **å®‰å…¨å­˜å‚¨** | API Key ä½¿ç”¨ SecureStore åŠ å¯†å­˜å‚¨ |
| ğŸŒ **å¤šè¯­è¨€** | æ”¯æŒä¸­æ–‡ã€è‹±æ–‡ã€æ—¥è¯­ç­‰å¤šè¯­è¨€ |

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Mobile App (Expo)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Chat UI    â”‚  â”‚  Vault UI    â”‚  â”‚  Settings    â”‚       â”‚
â”‚  â”‚  (useChat)   â”‚  â”‚  (æ–‡ä»¶æ ‘)    â”‚  â”‚  (æ¨¡å‹é…ç½®)  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                 â”‚                 â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              Agent Runtime (å…±äº«åŒ…)               â”‚       â”‚
â”‚  â”‚  @moryflow/agents-core, agents-runtime, agents-tools     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                             â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              Mobile Adapter                       â”‚       â”‚
â”‚  â”‚  expo-file-system â”‚ AsyncStorage â”‚ SecureStore   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¿«é€Ÿå¼€å§‹

```bash
# è¿›å…¥ç›®å½•
cd apps/mobile

# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# åœ¨ iOS æ¨¡æ‹Ÿå™¨è¿è¡Œ
pnpm ios

# åœ¨ Android æ¨¡æ‹Ÿå™¨è¿è¡Œ
pnpm android
```

## ç›®å½•ç»“æ„

```
apps/mobile/
â”œâ”€â”€ app/                    # Expo Router é¡µé¢
â”‚   â”œâ”€â”€ (tabs)/             # åº•éƒ¨ Tab å¯¼èˆª
â”‚   â”œâ”€â”€ (editor)/           # ç¼–è¾‘å™¨é¡µé¢
â”‚   â”œâ”€â”€ (chat)/             # Chat é¡µé¢
â”‚   â”œâ”€â”€ (settings)/         # è®¾ç½®é¡µé¢
â”‚   â””â”€â”€ (auth)/             # è®¤è¯é¡µé¢
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ agent-runtime/      # Agent è¿è¡Œæ—¶
â”‚   â”‚   â”œâ”€â”€ runtime.ts      # æ ¸å¿ƒåˆå§‹åŒ–é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ types.ts        # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ mobile-transport.ts  # Chat Transport
â”‚   â”‚   â”œâ”€â”€ session-store.ts     # ä¼šè¯å­˜å‚¨
â”‚   â”‚   â””â”€â”€ settings-store.ts    # è®¾ç½®å­˜å‚¨
â”‚   â”‚
â”‚   â”œâ”€â”€ vault/              # Vault æ–‡ä»¶æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ vault-service.ts     # æ–‡ä»¶æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ use-vault.ts         # React Hooks
â”‚   â”‚   â””â”€â”€ types.ts             # ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ editor/             # ç¼–è¾‘å™¨æ ¸å¿ƒ
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ components/             # UI ç»„ä»¶
â”‚   â”œâ”€â”€ chat/               # Chat ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ editor/             # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ vault/              # Vault ç»„ä»¶
â”‚   â””â”€â”€ ui/                 # é€šç”¨ UI ç»„ä»¶åº“
â”‚
â”œâ”€â”€ docs/                   # è¯¦ç»†è®¾è®¡æ–‡æ¡£
â””â”€â”€ ROADMAP.md              # å¼€å‘è¿›åº¦
```

## æ ¸å¿ƒæ¨¡å—

### Agent Runtime

æœ¬åœ° Agent è¿è¡Œæ—¶ï¼Œå¤ç”¨ `@moryflow/agents-*` å…±äº«åŒ…ï¼š

```typescript
// åˆå§‹åŒ–
await initAgentRuntime()

// è·å– Runtime
const runtime = await getAgentRuntime()

// è¿è¡Œå¯¹è¯
const { result } = await runtime.runChatTurn({
  chatId: 'xxx',
  input: 'Hello',
})

// æµå¼å¤„ç†
for await (const event of result) {
  // å¤„ç† Agent å“åº”
}
```

### Vault æœåŠ¡

æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼š

```typescript
// è¯»å–æ–‡ä»¶æ ‘
const nodes = await readTree('/')

// è¯»å†™æ–‡ä»¶
const content = await readFile('notes/hello.md')
await writeFile('notes/hello.md', '# Hello World')

// React Hooks
const { items, refresh, navigateTo } = useVaultTree()
const { content, save } = useVaultFile('notes/hello.md')
```

### ç¼–è¾‘å™¨

WebView + TipTap çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼š

```tsx
<EditorWithToolbar
  initialContent={content}
  onContentChange={handleChange}
  placeholder="å¼€å§‹ç¼–è¾‘..."
/>
```

## è¯¦ç»†æ–‡æ¡£

- [æŠ€æœ¯æ¶æ„](./docs/architecture.md)
- [Agent Runtime é€‚é…](./docs/agent-runtime.md)
- [Vault æœåŠ¡è®¾è®¡](./docs/vault-service.md)
- [ç¼–è¾‘å™¨è®¾è®¡](./docs/editor.md)
- [å¼€å‘è¿›åº¦](./ROADMAP.md)

## ä¸ PC ç«¯çš„å¯¹æ¯”

| èƒ½åŠ› | PC | Mobile |
|------|:--:|:------:|
| Agent + å·¥å…·è°ƒç”¨ | âœ… | âœ… |
| æœ¬åœ°æ–‡ä»¶ | âœ… Node.js fs | âœ… expo-file-system |
| æ¨¡å‹æ¥æº | æœ¬åœ° Key / äº‘ç«¯ | æœ¬åœ° Key |
| MCP æ‰©å±• | âœ… | âŒ æš‚ä¸æ”¯æŒ |
| Bash å·¥å…· | âœ… | âŒ ç¦ç”¨ |

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Expo SDK 54 + React Native 0.81
- **è·¯ç”±**: Expo Router 6
- **UI**: NativeWind (TailwindCSS)
- **çŠ¶æ€ç®¡ç†**: React Hooks + Context
- **å­˜å‚¨**: AsyncStorage + SecureStore + expo-file-system
- **ç¼–è¾‘å™¨**: TipTap + WebView
